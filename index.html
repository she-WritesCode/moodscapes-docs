<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Moodscapes V2 Specs</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="description" content="Description" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0" />
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/docsify@4/lib/themes/vue.css" />
    <style>
      .markdown-section iframe {
        border: none;
      }
    </style>
  </head>
  <body>
    <div id="app"></div>
    <script>
      window.$docsify = {
        name: "Moodscapes V2 Specs",
        repo: "https://github.com/she-WritesCode/moodscapes-docs",
        loadSidebar: true,
        subMaxLevel: 2,
        themeColor: "#0D9488",
      };
    </script>
    <!-- Docsify v4 -->
    <script src="//cdn.jsdelivr.net/npm/docsify@4"></script>

    <!-- Custom Plugins & Giscus Native Integration -->
    <script>
      window.$docsify.plugins = [
        // 1. Copy Full Page Markdown Plugin (For AI Prompting)
        function (hook, vm) {
          var rawMarkdown = "";
          hook.beforeEach(function (markdown) {
            rawMarkdown = markdown;
            var copyButton =
              '<button class="copy-page-btn" onclick="copyPageMarkdown()" style="float: right; margin-top: 5px; padding: 6px 12px; background: #0D9488; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: bold; font-family: sans-serif; box-shadow: 0 2px 4px rgba(0,0,0,0.1); transition: all 0.2s ease;">Copy Full Page for AI</button>\n\n';
            return copyButton + markdown;
          });

          window.copyPageMarkdown = function () {
            navigator.clipboard
              .writeText(rawMarkdown)
              .then(function () {
                var btns = document.querySelectorAll(".copy-page-btn");
                btns.forEach(function (btn) {
                  var originalText = btn.innerHTML;
                  btn.innerHTML = "Copied Markdown!";
                  btn.style.background = "#4CAF50";
                  setTimeout(function () {
                    btn.innerHTML = originalText;
                    btn.style.background = "#0D9488";
                  }, 2000);
                });
              })
              .catch(function (err) {
                console.error("Failed to copy text: ", err);
                alert("Could not copy text. Please select manually.");
              });
          };
        },
        // 2. Giscus Native Integration
        function (hook, vm) {
          // Append a container element below the markdown content
          hook.afterEach(function (html, next) {
            var giscusContainer = '<br/><br/><hr/><div class="giscus"></div>';
            next(html + giscusContainer);
          });

          // Inject the script into the container after rendering
          hook.doneEach(function () {
            var container = document.querySelector(".giscus");
            if (container) {
              // Ensure we don't load twice on page transitions
              container.innerHTML = "";

              var script = document.createElement("script");
              script.src = "https://giscus.app/client.js";
              script.setAttribute("data-repo", "she-WritesCode/moodscapes-docs");
              script.setAttribute("data-repo-id", "R_kgDORYKaWw");
              script.setAttribute("data-category", "Ideas");
              script.setAttribute("data-category-id", "DIC_kwDORYKaW84C3JUP");

              script.setAttribute("data-mapping", "url");
              script.setAttribute("data-strict", "0");
              script.setAttribute("data-reactions-enabled", "1");
              script.setAttribute("data-emit-metadata", "0");
              script.setAttribute("data-input-position", "top");
              script.setAttribute("data-theme", "preferred_color_scheme");
              script.setAttribute("data-lang", "en");
              script.setAttribute("data-loading", "lazy");
              script.crossOrigin = "anonymous";
              script.async = true;

              container.appendChild(script);
            }
          });
        },
      ].concat(window.$docsify.plugins || []);
    </script>
  </body>
</html>
